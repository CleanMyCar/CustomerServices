<div v-if="serviceDetail" class="panel panel-default">
    <div class="panel-heading">
        <span @click="navigateToBack" class="navigationIcon">
            <i class="fas fa-chevron-left"></i>
        </span>
        <h4>{{serviceType == 1 ? "SUBSCRIBE" : "Service / Delivery Me Once"}}</h4>
    </div>
    <div class="panel-body addBg">
        <div class="row">
            <div class="col-md-12">


                <div class="modal" data-backdrop="static" role="dialog" id="newVehicleDetailsPopup233">
                    <div class="modal-dialog" v-if="newVehicleDetails">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" style="position: absolute; right: 15px; top: 22px;"
                                    data-dismiss="modal">
                                    &times;
                                </button>
                                <h4>Add Vechile Details</h4>
                            </div>

                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">

                                            <div class="col-md-12 searchResultsAmenitiesDiv">
                                                <input type="text" placeholder="Please type here to choose address..."
                                                    v-model.trim="searchAddressText">
                                            </div>
                                            <div class="form-control searchResultsAmenities"
                                                @click="$event.stopPropagation()" id="propertyDropDown"
                                                v-show="showAddressList">
                                                <ul>
                                                    <li v-for="address in addressList" v-bind:value="address.AddressId"
                                                        @click="selectAddress(address)">
                                                        {{address.AddressLine1 + " " + address.AddressLine2 + ", " + address.Landmark + " " + address.CityName + ", " + address.StateName}}
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control" placeholder="Vehicle Name"
                                                v-model="newVehicleDetails.VehicleName">
                                        </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control" placeholder="Vehicle No"
                                                v-model="newVehicleDetails.VehicleNumber">
                                        </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control" placeholder="Vehicle Make"
                                                v-model="newVehicleDetails.VehicleMake">
                                        </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control" placeholder="Vehicle Model"
                                                v-model="newVehicleDetails.VehicleModel">
                                        </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control" placeholder="Parking Lot"
                                                v-model="newVehicleDetails.Parkinglot">
                                        </div>
                                        <div class="form-group">
                                            <img :src="newVehicleDetails.VehicleImage"
                                                v-if="newVehicleDetails.VehicleImage"
                                                style="height: 100px; width: 200px;" />

                                            <label class="custom-file-upload">
                                                <div>
                                                    <i class="fa fa-upload" aria-hidden="true"></i>
                                                    <input type="file" id="logo" name="logo" accept="image/*"
                                                        @change="filesChange($event)" />
                                                </div>

                                            </label>

                                        </div>
                                        <div class="form-group">
                                            <label v-for="vehicleType in vehicleTypes">
                                                <input type="radio" name="vehicleType"
                                                    @click="changeVehicleType(vehicleType, $event)"
                                                    v-model="newVehicleDetails.VehicleTypeId"
                                                    :value="vehicleType.VehicleTypeId">
                                                <i class="radioLabel">{{vehicleType.VehicleTypeName}}</i>
                                            </label>

                                        </div>
                                        <div class="form-group" v-if="newVehicleDetails.VehicleTypeId == 2">
                                            <label v-for="type in fourWheelerTypes">
                                                <input type="radio" name="fourWheelerType"
                                                    v-model="newVehicleDetails.FourWheelerTypeId" :value="type.Id">
                                                <i class="radioLabel">{{type.VehicleType}}</i>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-danger btn-sm pull-right" title="Cancel"
                                    @click="cancel">Cancel</button>
                                <button class="btn btn-success btn-sm pull-right" title="Save User"
                                    @click="addNewVehicle">Add</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">

                <div class="form-group">
                    <img :src="serviceDetail.ServiceImage ? serviceDetail.ServiceImage : (serviceDetail.VehicleCategoryType == 2 ? defaultCarImage : defaultBikeImage)"
                        height="150" width="300" @click="showMoreInfo(service)">
                    <div class="form-group serviceName">
                        <b>{{serviceDetail.ServiceName}}</b>
                    </div>
                </div>
                <div class="form-group" v-if="serviceType == 2 && serviceDetail.VehicleCategoryType != 3">
                    Personal Vehicle
                    <input type="checkbox" class="personalVehicle" name="personalVehicle"
                        @click="changeSelection(true, $event)" :checked="vehicleInfo.IsPersonal"> Yes
                    <input type="checkbox" class="personalVehicle" name="personalVehicle"
                        @click="changeSelection(false, $event)" :checked="!vehicleInfo.IsPersonal">No
                </div>
                <div class="form-group" v-if="serviceDetail.VehicleCategoryType != 3">
                    <div class="cellRow" style="width: 100%; overflow: scroll; margin-top: 20px;">
                        <div class="cell" v-for="product in myServiceProducts"
                            v-if="vehicleInfo.IsPersonal === (product.IsPersonal == 0 ? false : true)"
                            style="flex: 0 0 12%;">
                            <label class="radioLabel">
                                <input type="radio" class="vechiles" name="Vechile" :value="product.VehicleId"
                                    @click="chooseVehicle(product, $event)">
                                <img :src="product.VehicleImage ? product.VehicleImage : (product.VehicleTypeId == 2 ? defaultCarImage : defaultBikeImage)"
                                    height="120" width="120">
                            </label>

                            <div class="form-group serviceName">
                                {{product.VehicleNumber}}
                            </div>
                        </div>
                        <div class="cell" @click="addNewVehicleInfo">
                            <img :src="serviceDetail.VehicleCategoryType == 2 ? defaultCarImage : defaultBikeImage"
                                height="120" width="120">
                            <div class="form-group serviceName">
                                <a href="javascript:void(0)">Add New Vehicle</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div v-else>
                    <quantityComponent :inputValue="vehicleInfo.Quantity" :updateParent="updateQuantity">
                    </quantityComponent>
                </div>
                <div class="form-group" v-if="serviceType == 2" style="padding: 2px;">
                    <label>
                        Date
                    </label>
                    <datePickerComponent :keyString="'StartDate'" v-model="vehicleInfo.ServiceDate"
                        :value="vehicleInfo.ServiceDate" :format="'Do MMM YYYY'" :onUpdate="updateServiceDate"
                        :pickerType="'date'">
                    </datePickerComponent>

                </div>

                <div class="form-group" v-if="serviceType == 2">
                    <label>
                        Time Slot
                    </label>
                    <select v-model="vehicleInfo.TimeSlot" class="form-control">
                        <option value="1">6:00 AM - 8:00 AM</option>
                        <option value="2">8:00 AM - 10:00 AM</option>
                        <option value="3">10:00 AM - 12:00 PM</option>
                        <option value="4">12:00 PM - 2:00 PM</option>
                        <option value="5">2:00 PM - 4:00 PM</option>
                        <option value="6">4:00 PM - 6:00 PM</option>
                        <option value="7">6:00 PM - 8:00 PM</option>
                        <option value="8">8:00 PM - 10:00 PM</option>
                    </select>

                </div>

                <div class="row" v-if="serviceType == 1">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label>
                                Frequency
                            </label>

                        </div>
                        <div class="form-group">
                            <div class="cellRow">
                                <div class="cell" v-for="product in subscriptionTypes" style="flex: 0 0 12%;"
                                    v-if="serviceDetail.serviceSubscribeTypes.indexOf(product.SubscribeId) > -1">
                                    <label class="radioLabel customradioLabel">
                                        <input type="radio" name="serviceFrequency" :value="product.SubscribeId"
                                            v-model="vehicleInfo.Frequency" v-validate="'required'">
                                        <span class="form-group serviceName">
                                            {{product.SubscribeType}}
                                        </span>
                                    </label>

                                </div>

                            </div>
                        </div>
                        <div class="form-group">
                            <span v-show="errors.has('serviceFrequency')" class="invalid-feedback">
                                <i v-show="errors.has('serviceFrequency')" class="fa fa-warning"></i>
                                Please select Subscription Frequency
                            </span>
                        </div>
                        <div class="form-group" v-if="vehicleInfo.Frequency == 2">
                            <label>Day</label>

                            <input type="radio" value="0" name="weeklyDay" v-model="vehicleInfo.WeeklyDay">Sunday
                            <input type="radio" value="1" name="weeklyDay" v-model="vehicleInfo.WeeklyDay">Monday
                            <input type="radio" value="2" name="weeklyDay" v-model="vehicleInfo.WeeklyDay">Tuesday
                            <input type="radio" value="3" name="weeklyDay" v-model="vehicleInfo.WeeklyDay">Wednesday
                            <input type="radio" value="4" name="weeklyDay" v-model="vehicleInfo.WeeklyDay">Thursday
                            <input type="radio" value="5" name="weeklyDay" v-model="vehicleInfo.WeeklyDay">Friday
                            <input type="radio" value="6" name="weeklyDay" v-model="vehicleInfo.WeeklyDay">Saturday
                        </div>

                        <div class="form-group">
                            <label>
                                Start Date
                            </label>
                            <datePickerComponent :keyString="'StartDate'" v-model="vehicleInfo.ServiceDate"
                                :value="vehicleInfo.ServiceDate" :format="'Do MMM YYYY'" :onUpdate="updateServiceDate"
                                :pickerType="'date'">
                            </datePickerComponent>

                        </div>

                        <div class="form-group">
                            <label>
                                Time Slot
                            </label>
                            <select v-model="vehicleInfo.TimeSlot" class="form-control">
                                <option value="1">6:00 AM - 8:00 AM</option>
                                <option value="2">8:00 AM - 10:00 AM</option>
                                <option value="3">10:00 AM - 12:00 PM</option>
                                <option value="4">12:00 PM - 2:00 PM</option>
                                <option value="5">2:00 PM - 4:00 PM</option>
                                <option value="6">4:00 PM - 6:00 PM</option>
                                <option value="7">6:00 PM - 8:00 PM</option>
                                <option value="8">8:00 PM - 10:00 PM</option>
                            </select>

                        </div>

                        <div class="form-group">
                            <label>
                                Promo Code
                            </label>
                            <input type="text" v-model="vehicleInfo.Promocode" class="form-control"
                                placeholder="Promo Code">

                        </div>
                    </div>

                </div>

                <div class="address">

                    <div v-if="selectedPersonAddress" 
                        style="margin-top: 25px;float: left;">
                        <viewAddressComponent v-if="selectedPersonAddress" :addressId="selectedPersonAddress.AddressId"
                            :isDefault="selectedPersonAddress.IsDefault" disabled="true"></viewAddressComponent>
                    </div>
                    <div v-if="serviceDetail.VehicleCategoryType == 3 && userAddressList.length == 0">
                        You don't have any address to deliver this product, please add Address in <a href="javascript: void(0)" @click="navigateToMyProfile">My Profile</a> and confirm
                    </div>
                    <div style="float: right;" v-if="userAddressList.length > 1">
                        <a href="javascript: void(0)" @click="choosePersonAddress">Change</a>
                    </div>
                </div>

                <div class="address" v-if="vehicleAddress && vehicleAddress.VehicleId > 0">
                    <div>
                        <h5>Delivery/Service Address</h5>
                        <!-- <span style="float: right;" v-if="!vehicleAddress">
                            Add
                        </span> -->
                        <span style="float: right;" v-if="vehicleAddress" @click="editVehicleAddress">
                            Edit
                        </span>
                    </div>
                    <div v-if="vehicleAddress">
                        <div v-if="selectedVehicle">
                            Parking Lot: {{selectedVehicle.ParkingLot}}</div>
                        <div>
                            {{vehicleAddress.AddressLine1 + ", " + vehicleAddress.AddressLine2 }}
                        </div>
                        <div v-if="vehicleAddress.Landmark">
                            Landmark: {{vehicleAddress.Landmark }}
                        </div>
                        <div>
                            {{vehicleAddress.CityName + ", " + vehicleAddress.StateName }}
                        </div>
                        <div>
                            {{vehicleAddress.CountryName + ", " + vehicleAddress.Pincode }}
                        </div>
                    </div>

                </div>

                <div class="form-group">
                    <div
                        style="float: right; background-color: #008aff; color: white; width: 100%; font-weight: bold; text-align: right;">
                        Amount: â‚¹ {{servicePrice}}/-
                    </div>
                </div>
                <div class="form-group">
                    <div style="margin-top: 40px;">
                        <addToCartComponent
                            v-if="serviceType == 2 && ((serviceDetail.VehicleCategoryType != 3 && vehicleInfo.VehicleId) || (serviceDetail.VehicleCategoryType == 3 && (vehicleInfo.Quantity > 0 && selectedPersonAddress) ))"
                            :product="vehicleInfo" :serviceSaved="serviceSaved" :updateParent="confirmServiceOrder">
                        </addToCartComponent>
                        <button class="btn btn-success btn-sm pull-right"
                            :disabled="(serviceDetail.VehicleCategoryType != 3 && !vehicleInfo.VehicleId) || (serviceDetail.VehicleCategoryType == 3 && (vehicleInfo.Quantity < 1 || !selectedPersonAddress) )"
                            title="Confirm" @click="confirmServiceOrder(1)">Confirm</button>
                    </div>

                </div>
            </div>
        </div>

        <vehicleAddComponent v-if="openedVehicleAddPopup" :vehicleId="vehicleAddress && vehicleAddress.VehicleId"
            :updateParent="updateVehicleAddress" :isPersonal="vehicleInfo.IsPersonal"
            :closeVehicleAddPopup="closeVehicleAddPopup" :serviceDetail="serviceDetail"></vehicleAddComponent>

        <addressChooseComponent v-if="isAddressPopup"
            :selectedAddress="updateSelectedAddress" 
            :closeVehicleAddPopup="closeSelectAddressPopup"></addressChooseComponent>
    </div>
</div>